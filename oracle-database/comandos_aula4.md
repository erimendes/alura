Chegou a hora de você pôr em prática o que foi visto na aula. Para isso, execute os passos listados abaixo.

1) No Oracle SQL Developer, crie uma nova janela de script.

2) Para visualizar a TABELA_DE_VENDEDORES, execute:

SELECT * FROM TABELA_DE_VENDEDORES;Copiar código
3) Para visualizar a tabela NOTAS_FISCAIS, execute:

SELECT * FROM NOTAS_FISCAIS;Copiar código
4) Para mostrar quantas notas fiscais cada vendedor vendeu, execute:

SELECT MATRICULA, COUNT(*) AS NUMERO_DE_NOTAS FROM NOTAS_FISCAIS
GROUP BY MATRICULA;Copiar código
5) Para ver o nome do vendedor na visualização, execute:

SELECT NOTAS_FISCAIS.MATRICULA
, TABELA_DE_VENDEDORES.NOME
, COUNT(*) AS NUMERO_DE_NOTAS 
FROM 
NOTAS_FISCAIS
INNER JOIN
TABELA_DE_VENDEDORES
ON NOTAS_FISCAIS.MATRICULA = TABELA_DE_VENDEDORES.MATRICULA
GROUP BY NOTAS_FISCAIS.MATRICULA, TABELA_DE_VENDEDORES.NOME;Copiar código
6) Acertando a ordem das tabelas, execute:

SELECT NOTAS_FISCAIS.MATRICULA
, TABELA_DE_VENDEDORES.NOME
, COUNT(*) AS NUMERO_DE_NOTAS 
FROM 
TABELA_DE_VENDEDORES
INNER JOIN
NOTAS_FISCAIS
ON NOTAS_FISCAIS.MATRICULA = TABELA_DE_VENDEDORES.MATRICULA
GROUP BY NOTAS_FISCAIS.MATRICULA, TABELA_DE_VENDEDORES.NOME;Copiar código
7) Use Alias:

SELECT NF.MATRICULA
, TV.NOME
, COUNT(*) AS NUMERO_DE_NOTAS 
FROM 
TABELA_DE_VENDEDORES TV
INNER JOIN
NOTAS_FISCAIS NF
ON NF.MATRICULA = TV.MATRICULA
GROUP BY NF.MATRICULA, TV.NOME;Copiar código
8) Crie um script novo.

9) Para saber quais clientes fizeram uma compra, execute o código:

SELECT DISTINCT
TC.CPF AS CPF_DO_CADASTRO
,TC.NOME AS NOME_DO_CLIENTE
,NF.CPF AS CPF_NOTAS_FISCAIS
FROM
TABELA_DE_CLIENTES TC
INNER JOIN
NOTAS_FISCAIS NF
ON TC.CPF = NF.CPF;Copiar código
10) Quantos clientes tem no cadastro, execute:

SELECT COUNT(*) FROM TABELA_DE_CLIENTES;Copiar código
11) Caso você ainda não tenha feito, faça o download do arquivo NovoCliente.sql.

12) Use o comando INSERT:

INSERT INTO TABELA_DE_CLIENTES 
(CPF, NOME, ENDERECO_1, ENDERECO_2, BAIRRO, CIDADE, ESTADO, CEP, DATA_DE_NASCIMENTO, IDADE, 
GENERO, LIMITE_DE_CREDITO, VOLUME_DE_COMPRA, PRIMEIRA_COMPRA) 
VALUES ('23412632331', 'Juliana Silva', 'R. Tramandai', '', 'Bangu', 'Rio de Janeiro', 
'RJ', '23400000', TO_DATE('1989-02-04','YYYY-MM-DD'), 28, 'F', 180000.0000, 24500, 0);Copiar código
13) Execute o código abaixo para mostrar todos os clientes:

SELECT DISTINCT
TC.CPF AS CPF_DO_CADASTRO
,TC.NOME AS NOME_DO_CLIENTE
,NF.CPF AS CPF_NOTAS_FISCAIS
FROM
TABELA_DE_CLIENTES TC
LEFT JOIN
NOTAS_FISCAIS NF
ON TC.CPF = NF.CPF;Copiar código
14) Mostra o cliente que nunca comprou:

SELECT DISTINCT
TC.CPF AS CPF_DO_CADASTRO
,TC.NOME AS NOME_DO_CLIENTE
,NF.CPF AS CPF_NOTAS_FISCAIS
FROM
TABELA_DE_CLIENTES TC
LEFT JOIN
NOTAS_FISCAIS NF
ON TC.CPF = NF.CPF
WHERE NF.CPF IS NULL;Copiar código
15) Para tirar a coluna indesejada CPF_NOTAS_FISCAIS, execute:

SELECT DISTINCT
TC.CPF AS CPF_DO_CADASTRO
,TC.NOME AS NOME_DO_CLIENTE
FROM
TABELA_DE_CLIENTES TC
LEFT JOIN
NOTAS_FISCAIS NF
ON TC.CPF = NF.CPF
WHERE NF.CPF IS NULL;Copiar código
16) Faça o JOIN pelo campo BAIRRO:

SELECT DISTINCT
TV.NOME AS NOME_DO_VENDEDOR
,TV.BAIRRO AS BAIRRO_DO_VENDEDOR
,TC.NOME AS NOME_DO_CLIENTE
,TC.BAIRRO AS BAIRRO_DO_CLIENTE
FROM
TABELA_DE_CLIENTES TC
INNER JOIN
TABELA_DE_VENDEDORES TV
ON TV.BAIRRO = TC.BAIRRO;Copiar código
17) Mostre a quantidade de vendedores:

SELECT COUNT(*) FROM TABELA_DE_VENDEDORES;Copiar código
18) Para mostrar o cliente onde não tem vendedor, execute:

SELECT DISTINCT
TV.NOME AS NOME_DO_VENDEDOR
,TV.BAIRRO AS BAIRRO_DO_VENDEDOR
,TC.NOME AS NOME_DO_CLIENTE
,TC.BAIRRO AS BAIRRO_DO_CLIENTE
FROM
TABELA_DE_CLIENTES TC
LEFT JOIN
TABELA_DE_VENDEDORES TV
ON TV.BAIRRO = TC.BAIRRO;Copiar código
19) Para saber quais são os vendedores que tem escritório onde não tem cliente, execute:

SELECT DISTINCT
TV.NOME AS NOME_DO_VENDEDOR
,TV.BAIRRO AS BAIRRO_DO_VENDEDOR
,TC.NOME AS NOME_DO_CLIENTE
,TC.BAIRRO AS BAIRRO_DO_CLIENTE
FROM
TABELA_DE_CLIENTES TC
RIGHT JOIN
TABELA_DE_VENDEDORES TV
ON TV.BAIRRO = TC.BAIRRO;Copiar código
20) Junte todos os casos:

SELECT DISTINCT
TV.NOME AS NOME_DO_VENDEDOR
,TV.BAIRRO AS BAIRRO_DO_VENDEDOR
,TC.NOME AS NOME_DO_CLIENTE
,TC.BAIRRO AS BAIRRO_DO_CLIENTE
FROM
TABELA_DE_CLIENTES TC
FULL JOIN
TABELA_DE_VENDEDORES TV
ON TV.BAIRRO = TC.BAIRRO;Copiar código
21) Crie um novo script e execute o comando abaixo:

SELECT DISTINCT BAIRRO FROM TABELA_DE_CLIENTES;Copiar código
Serão achados 12 bairros.

22) Execute o comando abaixo e veja que aparecem 4 bairros:

SELECT DISTINCT BAIRRO FROM TABELA_DE_VENDEDORES;Copiar código
23) Unindo as duas consultas, você terá 13 bairros como resposta:

SELECT DISTINCT BAIRRO FROM TABELA_DE_CLIENTES
UNION
SELECT DISTINCT BAIRRO FROM TABELA_DE_VENDEDORES;Copiar código
24) Se você usar o UNION ALL, irá aparecer como resposta 16 bairros:

SELECT DISTINCT BAIRRO FROM TABELA_DE_CLIENTES
UNION ALL
SELECT DISTINCT BAIRRO FROM TABELA_DE_VENDEDORES;Copiar código
25) Para identificar de qual tabela está vindo a linha, execute:

SELECT DISTINCT BAIRRO, 'CLIENTE' AS ORIGEM FROM TABELA_DE_CLIENTES
UNION ALL
SELECT DISTINCT BAIRRO, 'FORNECEDOR' AS ORIGEM  FROM TABELA_DE_VENDEDORES;Copiar código
26) Como mais uma coluna foi adicionada, o resultado será o mesmo:

SELECT DISTINCT BAIRRO, 'CLIENTE' AS ORIGEM FROM TABELA_DE_CLIENTES
UNION
SELECT DISTINCT BAIRRO, 'FORNECEDOR' AS ORIGEM  FROM TABELA_DE_VENDEDORES;Copiar código
27) Crie um novo script e execute o seguinte comando:

SELECT DISTINCT BAIRRO FROM TABELA_DE_VENDEDORES;Copiar código
28) Com o código abaixo, são mostrados os clientes com sua sede em bairros onde há vendedores:

SELECT * FROM TABELA_DE_CLIENTES WHERE BAIRRO IN (
'Tijuca',
'Jardins',
'Copacabana',
'Santo Amaro');Copiar código
29) De uma maneira melhor, você terá o código:

SELECT * FROM TABELA_DE_CLIENTES WHERE BAIRRO IN 
(SELECT DISTINCT BAIRRO FROM TABELA_DE_VENDEDORES);Copiar código
30) Em um novo script, execute o código abaixo:

SELECT EMBALAGEM, SUM(PRECO_DE_LISTA) AS SOMA_PRECO
FROM TABELA_DE_PRODUTOS GROUP BY EMBALAGEM;Copiar código
31) Use o comando HAVING para mostrar os preços acima de 80:

SELECT EMBALAGEM, SUM(PRECO_DE_LISTA) AS SOMA_PRECO
FROM TABELA_DE_PRODUTOS GROUP BY EMBALAGEM
HAVING SUM(PRECO_DE_LISTA) >= 80;Copiar código
32) Faça uma consulta usando a subconsulta com o WHERE:

SELECT SOMA_EMBALAGENS.EMBALAGEM,SOMA_EMBALAGENS.SOMA_PRECO
FROM
(
SELECT EMBALAGEM, SUM(PRECO_DE_LISTA) AS SOMA_PRECO
FROM TABELA_DE_PRODUTOS GROUP BY EMBALAGEM
) SOMA_EMBALAGENS
WHERE SOMA_EMBALAGENS.SOMA_PRECO >= 80;Copiar código
33) Crie uma visão com VIEW:

CREATE VIEW VW_SOMA_EMBALAGENS AS
SELECT EMBALAGEM, SUM(PRECO_DE_LISTA) AS SOMA_PRECO
FROM TABELA_DE_PRODUTOS GROUP BY EMBALAGEM;Copiar código
34) Selecione registros de uma visão:

SELECT EMBALAGEM, SOMA_PRECO FROM VW_SOMA_EMBALAGENS
WHERE SOMA_PRECO >= 80;Copiar código
35) Para listar todos os produtos cuja soma de embalagem é maior que 80, execute o código:

SELECT * FROM TABELA_DE_PRODUTOS TP
INNER JOIN VW_SOMA_EMBALAGENS VW
ON TP.EMBALAGEM = VW.EMBALAGEM
WHERE VW.SOMA_PRECO >= 80;